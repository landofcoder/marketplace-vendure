
<div>
    <h6>Order Processing</h6>
    <div  *ngIf="activePreset$ | async as activePreset">
        <div class="btn-group">
            <button class="btn"
            [class.btn-primary]="activePreset === 'new'"
            (click)="selectFilterPreset('new')">
                <p>{{ (countOrderByStatus$ | async)?.new || 0}}</p>
                New
            </button>
            <button class="btn"
            [class.btn-primary]="activePreset === 'packed'"
            (click)="selectFilterPreset('packed')"
            >
                <p>{{ (countOrderByStatus$ | async)?.packed || 0}}</p>
                Pack
            </button>
            <button class="btn"
            [class.btn-primary]="activePreset === 'handover'"
            (click)="selectFilterPreset('handover')"
            >
                <p>{{ (countOrderByStatus$ | async)?.handover || 0}}</p>
                Handover
            </button>
        </div>

        <div class="btn-group">
            <button class="btn"
            [class.btn-primary]="activePreset === 'transit'"
            (click)="selectFilterPreset('transit')"
            >
                <p>{{ (countOrderByStatus$ | async)?.transit || 0}}</p>
                Transit
            </button>
            <button class="btn"
            [class.btn-primary]="activePreset === 'delivered'"
            (click)="selectFilterPreset('delivered')"
            >
                <p>{{ (countOrderByStatus$ | async)?.delivered || 0}}</p>
                Delivered
            </button>
        </div>

        <div class="btn-group">
            <button class="btn"
            [class.btn-primary]="activePreset === 'upcomming'"
            (click)="selectFilterPreset('upcomming')"
            >
                <p>{{ (countOrderByStatus$ | async)?.upcomming || 0}}</p>
                Upcoming
            </button>
        </div>

        <div class="btn-group">
            <button class="btn"
            [class.btn-primary]="activePreset === 'returned'"
            (click)="selectFilterPreset('returned')"
            >
                <p>{{ (countOrderByStatus$ | async)?.returned || 0}}</p>
                Return
            </button>
            <button class="btn"
            [class.btn-primary]="activePreset === 'cancelled'"
            (click)="selectFilterPreset('cancelled')"
            >
                <p>{{ (countOrderByStatus$ | async)?.cancelled || 0}}</p>
                Cancel
            </button>
        </div>

    </div>

    <h6>Filters</h6>
    <div class="filter">
        <input
                type="text"
                name="searchTerm"
                [formControl]="searchTerm"
                [placeholder]="'order.search-by-order-code' | translate"
                class="clr-input style-input"
        />

        <input
                type="text"
                class="form-control clr-input style-input"
                ngxDaterangepickerMd
                [(ngModel)]="selectedDate"
                [placeholder]="'fulfill.order_list.range' | translate"
        />
        <button class="btn btn-primary" (click)="applyCustomFilters()">
            <clr-icon shape="filter"></clr-icon>
            Apply Filter
        </button>
    </div>
</div>

<clr-datagrid>

    <clr-dg-column>{{ 'common.code' | translate }}</clr-dg-column>
<!--    <clr-dg-column>{{ 'order.customer' | translate }}</clr-dg-column>-->
    <clr-dg-column class="product-info">{{ 'fulfill.order_list.product_info' | translate }}</clr-dg-column>
    <clr-dg-column>{{ 'order.total' | translate }}</clr-dg-column>
    <clr-dg-column>{{ 'order.state' | translate }}</clr-dg-column>
    <clr-dg-column>{{ 'common.updated-at' | translate }}</clr-dg-column>
    <clr-dg-column></clr-dg-column>

    <clr-dg-row
            *clrDgItems="let order of (items$ | async) |paginate:  (paginationConfig$ | async) || {}"
            [clrDgItem]="order"
    >
        <clr-dg-cell class="clr-align-self-center">
            <a (click)="openOrderDetail(order)">{{ formatOrderCode(order.code)}}</a>
        </clr-dg-cell>
<!--        <clr-dg-cell class="clr-align-self-center">-->
<!--            <vdr-customer-label [customer]="order.customer"></vdr-customer-label>-->
<!--        </clr-dg-cell>-->

        <clr-dg-cell class="product-info">
            <vdr-order-list-lines [order-id]="order.id"></vdr-order-list-lines>
        </clr-dg-cell>

        <clr-dg-cell class="clr-align-self-center">
            {{ order.total / 100 | currency: order.currencyCode }}
        </clr-dg-cell>

        <clr-dg-cell class="clr-align-self-center">
            <vdr-order-state-label [state]="order.state"></vdr-order-state-label>
        </clr-dg-cell>

        <clr-dg-cell class="clr-align-self-center">
            {{ order.updatedAt | date: 'medium' }}
        </clr-dg-cell>

        <clr-dg-cell class="clr-align-self-center">
            <vdr-table-row-action
                    iconShape="shopping-cart"
                    [label]="'common.open' | translate"
                    [linkTo]="['./', order.id]"
            ></vdr-table-row-action>
        </clr-dg-cell>

    </clr-dg-row>


    <!-- Expand table -->
    <ng-template [(clrIfDetail)]="currentOrderSelected$" let-order>
        <clr-dg-detail >

            <clr-dg-detail-header>Order Code: #{{order.code}}</clr-dg-detail-header>
            <clr-dg-detail-body>
                <vdr-order-detail-popup [order-id]="order.id"></vdr-order-detail-popup>
            </clr-dg-detail-body>
        </clr-dg-detail>
    </ng-template>

</clr-datagrid>

<div class="table-footer">
    <vdr-items-per-page-controls *ngIf="totalItems$ | async" [itemsPerPage]="itemsPerPage$ | async"
                                 (itemsPerPageChange)="setItemsPerPage($event)"></vdr-items-per-page-controls>
    <vdr-pagination-controls *ngIf="totalItems$ | async" [currentPage]="currentPage$ | async"
                             [itemsPerPage]="itemsPerPage$ | async" [totalItems]="totalItems$ | async" (pageChange)="setPageNumber($event)">
    </vdr-pagination-controls>
</div>

